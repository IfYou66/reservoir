{"remainingRequest":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\src\\api\\collection\\excel.js","dependencies":[{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\src\\api\\collection\\excel.js","mtime":1640096690485},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711181250741},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1711181252330},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\eslint-loader\\index.js","mtime":1711181251177}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi9HcmFkdWF0aW9uUHJvamVjdC9maW5hbC9yZXNlcnZpb2lyL3Jlc2VydmlvaXItdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0IikuZGVmYXVsdDsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5jb252ZXJ0ID0gY29udmVydDsKCnZhciBfdHlwZW9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiRDovR3JhZHVhdGlvblByb2plY3QvZmluYWwvcmVzZXJ2aW9pci9yZXNlcnZpb2lyLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3R5cGVvZiIpKTsKCi8qKgogKiDmraTmqKHlnZfotJ/otKNleGNlbOihqOeahOi+k+WHuuW3peS9nAogKi8KZnVuY3Rpb24gY29udmVydChKU09ORGF0YSwgRmlsZU5hbWUsIHRpdGxlLCBmaWx0ZXIpIHsKICBpZiAoIUpTT05EYXRhKSByZXR1cm47IC8v6L2s5YyWanNvbuS4um9iamVjdAoKICB2YXIgYXJyRGF0YSA9ICgwLCBfdHlwZW9mMi5kZWZhdWx0KShKU09ORGF0YSkgIT0gJ29iamVjdCcgPyBKU09OLnBhcnNlKEpTT05EYXRhKSA6IEpTT05EYXRhOwogIHZhciBleGNlbCA9ICI8dGFibGU+IjsgLy/orr7nva7ooajlpLQKCiAgdmFyIHJvdyA9ICI8dHI+IjsKCiAgaWYgKHRpdGxlKSB7CiAgICAvL+S9v+eUqOagh+mimOmhuQogICAgZm9yICh2YXIgaSBpbiB0aXRsZSkgewogICAgICByb3cgKz0gIjx0aCBhbGlnbj0nY2VudGVyJz4iICsgdGl0bGVbaV0gKyAnPC90aD4nOwogICAgfQogIH0gZWxzZSB7CiAgICAvL+S4jeS9v+eUqOagh+mimOmhuQogICAgZm9yICh2YXIgX2kgaW4gYXJyRGF0YVswXSkgewogICAgICByb3cgKz0gIjx0aCBhbGlnbj0nY2VudGVyJz4iICsgX2kgKyAnPC90aD4nOwogICAgfQogIH0KCiAgZXhjZWwgKz0gcm93ICsgIjwvdHI+IjsgLy/orr7nva7mlbDmja4KCiAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgYXJyRGF0YS5sZW5ndGg7IF9pMisrKSB7CiAgICB2YXIgX3JvdyA9ICI8dHI+IjsKCiAgICBmb3IgKHZhciBpbmRleCBpbiBhcnJEYXRhW19pMl0pIHsKICAgICAgLy/liKTmlq3mmK/lkKbmnInov4fmu6TooYwKICAgICAgaWYgKGZpbHRlcikgewogICAgICAgIGlmIChmaWx0ZXIuaW5kZXhPZihpbmRleCkgPT0gLTEpIHsKICAgICAgICAgIHZhciB2YWx1ZSA9IGFyckRhdGFbX2kyXVtpbmRleF0gPT0gbnVsbCA/ICIiIDogYXJyRGF0YVtfaTJdW2luZGV4XTsKICAgICAgICAgIF9yb3cgKz0gJzx0ZD4nICsgdmFsdWUgKyAnPC90ZD4nOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX3ZhbHVlID0gYXJyRGF0YVtfaTJdW2luZGV4XSA9PSBudWxsID8gIiIgOiBhcnJEYXRhW19pMl1baW5kZXhdOwoKICAgICAgICBfcm93ICs9ICI8dGQgYWxpZ249J2NlbnRlcic+IiArIF92YWx1ZSArICI8L3RkPiI7CiAgICAgIH0KICAgIH0KCiAgICBleGNlbCArPSBfcm93ICsgIjwvdHI+IjsKICB9CgogIGV4Y2VsICs9ICI8L3RhYmxlPiI7CiAgdmFyIGV4Y2VsRmlsZSA9ICI8aHRtbCB4bWxuczpvPSd1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTpvZmZpY2UnIHhtbG5zOng9J3VybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOmV4Y2VsJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MCc+IjsKICBleGNlbEZpbGUgKz0gJzxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0iYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsOyBjaGFyc2V0PVVURi04Ij4nOwogIGV4Y2VsRmlsZSArPSAnPG1ldGEgaHR0cC1lcXVpdj0iY29udGVudC10eXBlIiBjb250ZW50PSJhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnOwogIGV4Y2VsRmlsZSArPSAnOyBjaGFyc2V0PVVURi04Ij4nOwogIGV4Y2VsRmlsZSArPSAiPGhlYWQ+IjsKICBleGNlbEZpbGUgKz0gIjwhLS1baWYgZ3RlIG1zbyA5XT4iOwogIGV4Y2VsRmlsZSArPSAiPHhtbD4iOwogIGV4Y2VsRmlsZSArPSAiPHg6RXhjZWxXb3JrYm9vaz4iOwogIGV4Y2VsRmlsZSArPSAiPHg6RXhjZWxXb3Jrc2hlZXRzPiI7CiAgZXhjZWxGaWxlICs9ICI8eDpFeGNlbFdvcmtzaGVldD4iOwogIGV4Y2VsRmlsZSArPSAiPHg6TmFtZT4iOwogIGV4Y2VsRmlsZSArPSAie3dvcmtzaGVldH0iOwogIGV4Y2VsRmlsZSArPSAiPC94Ok5hbWU+IjsKICBleGNlbEZpbGUgKz0gIjx4OldvcmtzaGVldE9wdGlvbnM+IjsKICBleGNlbEZpbGUgKz0gIjx4OkRpc3BsYXlHcmlkbGluZXMvPiI7CiAgZXhjZWxGaWxlICs9ICI8L3g6V29ya3NoZWV0T3B0aW9ucz4iOwogIGV4Y2VsRmlsZSArPSAiPC94OkV4Y2VsV29ya3NoZWV0PiI7CiAgZXhjZWxGaWxlICs9ICI8L3g6RXhjZWxXb3Jrc2hlZXRzPiI7CiAgZXhjZWxGaWxlICs9ICI8L3g6RXhjZWxXb3JrYm9vaz4iOwogIGV4Y2VsRmlsZSArPSAiPC94bWw+IjsKICBleGNlbEZpbGUgKz0gIjwhW2VuZGlmXS0tPiI7CiAgZXhjZWxGaWxlICs9ICI8L2hlYWQ+IjsKICBleGNlbEZpbGUgKz0gIjxib2R5PiI7CiAgZXhjZWxGaWxlICs9IGV4Y2VsOwogIGV4Y2VsRmlsZSArPSAiPC9ib2R5PiI7CiAgZXhjZWxGaWxlICs9ICI8L2h0bWw+IjsKICB2YXIgdXJpID0gJ2RhdGE6YXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsO2NoYXJzZXQ9dXRmLTgsJyArIGVuY29kZVVSSUNvbXBvbmVudChleGNlbEZpbGUpOwogIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogIGxpbmsuaHJlZiA9IHVyaTsKICBsaW5rLnN0eWxlID0gInZpc2liaWxpdHk6aGlkZGVuIjsKICBsaW5rLmRvd25sb2FkID0gRmlsZU5hbWUgKyAiLnhscyI7CiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsKICBsaW5rLmNsaWNrKCk7CiAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsKfQ=="},{"version":3,"sources":["D:/GraduationProject/final/reservioir/reservioir-ui/src/api/collection/excel.js"],"names":["convert","JSONData","FileName","title","filter","arrData","JSON","parse","excel","row","i","length","index","indexOf","value","excelFile","uri","encodeURIComponent","link","document","createElement","href","style","download","body","appendChild","click","removeChild"],"mappings":"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","sourcesContent":["/**\n * 此模块负责excel表的输出工作\n */\n\nexport function convert(JSONData, FileName, title, filter) {\n  if (!JSONData)\n    return;\n  //转化json为object\n  let arrData = typeof JSONData != 'object' ? JSON.parse(JSONData) : JSONData;\n\n  let excel = \"<table>\";\n\n  //设置表头\n  let row = \"<tr>\";\n\n  if (title) {\n    //使用标题项\n    for (let i in title) {\n      row += \"<th align='center'>\" + title[i] + '</th>';\n    }\n\n  } else {\n    //不使用标题项\n    for (let i in arrData[0]) {\n      row += \"<th align='center'>\" + i + '</th>';\n    }\n  }\n\n  excel += row + \"</tr>\";\n\n  //设置数据\n  for (let i = 0; i < arrData.length; i++) {\n    let row = \"<tr>\";\n\n    for (let index in arrData[i]) {\n      //判断是否有过滤行\n      if (filter) {\n        if (filter.indexOf(index) == -1) {\n          let value = arrData[i][index] == null ? \"\" : arrData[i][index];\n          row += '<td>' + value + '</td>';\n        }\n      } else {\n        let value = arrData[i][index] == null ? \"\" : arrData[i][index];\n        row += \"<td align='center'>\" + value + \"</td>\";\n      }\n    }\n\n    excel += row + \"</tr>\";\n  }\n\n  excel += \"</table>\";\n\n  let excelFile = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>\";\n  excelFile += '<meta http-equiv=\"content-type\" content=\"application/vnd.ms-excel; charset=UTF-8\">';\n  excelFile += '<meta http-equiv=\"content-type\" content=\"application/vnd.ms-excel';\n  excelFile += '; charset=UTF-8\">';\n  excelFile += \"<head>\";\n  excelFile += \"<!--[if gte mso 9]>\";\n  excelFile += \"<xml>\";\n  excelFile += \"<x:ExcelWorkbook>\";\n  excelFile += \"<x:ExcelWorksheets>\";\n  excelFile += \"<x:ExcelWorksheet>\";\n  excelFile += \"<x:Name>\";\n  excelFile += \"{worksheet}\";\n  excelFile += \"</x:Name>\";\n  excelFile += \"<x:WorksheetOptions>\";\n  excelFile += \"<x:DisplayGridlines/>\";\n  excelFile += \"</x:WorksheetOptions>\";\n  excelFile += \"</x:ExcelWorksheet>\";\n  excelFile += \"</x:ExcelWorksheets>\";\n  excelFile += \"</x:ExcelWorkbook>\";\n  excelFile += \"</xml>\";\n  excelFile += \"<![endif]-->\";\n  excelFile += \"</head>\";\n  excelFile += \"<body>\";\n  excelFile += excel;\n  excelFile += \"</body>\";\n  excelFile += \"</html>\";\n\n\n  let uri = 'data:application/vnd.ms-excel;charset=utf-8,' + encodeURIComponent(excelFile);\n\n  let link = document.createElement(\"a\");\n  link.href = uri;\n\n  link.style = \"visibility:hidden\";\n  link.download = FileName + \".xls\";\n\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n"]}]}