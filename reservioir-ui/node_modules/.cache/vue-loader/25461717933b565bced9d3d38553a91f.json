{"remainingRequest":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\src\\views\\runManagement\\dispatch\\instructionReceived.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\src\\views\\runManagement\\dispatch\\instructionReceived.vue","mtime":1641226348461},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":1711181251489},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1711181253421},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":1711181252308},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1711181250722},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711181250741},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1711181252689}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmNvbG9yNDA5IHsKICBjb2xvcjogIzQwOWVmZjsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KLmluc3RydWN0aW9uUmVjZWl2ZWR7CiAgLmVsLXVwbG9hZC1saXN0ewogICAgbWFyZ2luLWxlZnQ6IDEyMHB4OwogICAgbWFyZ2luLXRvcDogLTYwcHg7CiAgfQp9Cgo="},{"version":3,"sources":["instructionReceived.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAi1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"instructionReceived.vue","sourceRoot":"src/views/runManagement/dispatch","sourcesContent":["<template>\n  <div class=\"app-container instructionReceived\">\n     <el-row class=\"from-top\">\n      <!-- <el-col :span=\"24\">\n        <div style=\"margin: 0 auto;display: flex;align-items: center;width: 100%;justify-content:center;\">\n          <div style=\"position: relative;\">\n            <img src=\"../../../assets/images/01s.png\"/>\n            <div  style=\"position: absolute;top: 17px;left: 23px;width: 50%;color: #FFFFFF;\">指令接收</div>\n          </div>\n          <div  style=\"position: relative; width: 30%;\">\n            <img :src=\"require(active>1? '../../../assets/images/04.png':'../../../assets/images/05.png')\"  style=\"width: 100%;\"/>\n            <img v-if=\"active==1\" :src=\"require(active==1? '../../../assets/images/07.gif':'../../../assets/images/06.gif')\" style=\"position: absolute;top: 0px;left: 150px;height: 80%;width: 10%;\"/>\n            </div>\n          <div  style=\"position: relative;\">\n            <img :src=\"require(active>1? '../../../assets/images/01s.png':'../../../assets/images/01.png')\" />\n            <div  :style=\"active>1? 'position: absolute;top: 17px;left: 23px;width: 50%;color: #FFFFFF;':'position: absolute;top: 17px;left: 23px;width: 50%;color: #999999;'\">指令执行</div>\n            </div>\n          <div  style=\"position: relative; width: 30%;\">\n            <img :src=\"require(active==3? '../../../assets/images/04.png':'../../../assets/images/05.png')\" style=\"width: 100%;\" />\n            <img v-if=\"active==2 || active==1\" :src=\"require(active==2? '../../../assets/images/07.gif':'../../../assets/images/06.gif')\" style=\"position: absolute;top: 0px;left: 150px;height: 80%;width: 10%;\"/>\n            </div>\n          <div   style=\"position: relative;\">\n            <img :src=\"require(active==3? '../../../assets/images/01s.png':'../../../assets/images/01.png')\" />\n            <div  :style=\"active>1? 'position: absolute;top: 17px;left: 23px;width: 50%;color: #FFFFFF;':'position: absolute;top: 17px;left: 23px;width: 50%;color: #999999;'\">指令反馈</div>\n            </div>\n        </div>\n      </el-col> -->\n\n      <el-col :span=\"24\">\n        <div style=\"margin: 0 auto;display: flex;align-items: center;width: 100%;justify-content:center;\">\n          <div style=\"position: relative;\">\n            <img src=\"../../../assets/images/jin.png\"/>\n            <div  style=\"position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;\">1.指令接收</div>\n          </div>\n          <div  style=\"position: relative;\">\n            <img :src=\"require(active>1? '../../../assets/images/jin.png':'../../../assets/images/jin1.png')\" />\n            <div  :style=\"active>1? 'position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;':'position: absolute;top: 10px;left: 100px;width: 50%;color: #757575;'\">2.指令执行</div>\n            </div>\n          <div   style=\"position: relative;\">\n            <img :src=\"require(active>=3? '../../../assets/images/jin.png':'../../../assets/images/jin1.png')\" />\n            <div  :style=\"active>1? 'position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;':'position: absolute;top: 10px;left: 100px;width: 50%;color: #757575;'\">3.指令反馈</div>\n            </div>\n        </div>\n      </el-col>\n    </el-row>\n    <div  class=\"from-div\">\n      <el-row>\n        <el-col :span=\"24\"\n        class=\"from-div-title\"\n        style=\"background-color: rgba(215, 215, 215, 1); text-align: right;\"\n         >\n        <div>\n          <el-button v-if=\"active == 1 && formData.fId == null || formData.fId == '' \" type=\"primary\" size=\"small\" style=\"margin-right: 5px\" @click=\"submit(0)\">暂存\n          </el-button>\n          <el-button v-if=\"active == 1\" type=\"primary\" size=\"small\" style=\"margin-right: 20px\" @click=\"submit(1)\">提交\n          </el-button>\n          <el-button v-if=\"active == 2 \" type=\"primary\" size=\"small\" style=\"margin-right: 20px\" @click=\"execution\">指令执行</el-button>\n          <el-button v-if=\"active == 3 \" type=\"primary\" size=\"small\" style=\"margin-right: 20px\" @click=\"report\">结果反馈</el-button>\n        </div>\n        </el-col>\n      </el-row>\n      <el-row>\n        <el-col :span=\"24\"\n        class=\"from-div-title\">调度指令执行一览表</el-col>\n      </el-row>\n\n      <el-row class=\"from-border-bottom\" >\n        <el-col :span=\"3\" class=\"from-col-left\" >\n          调度指令名称\n        </el-col>\n        <el-col :span=\"9\" class=\"from-border-right\" >\n          <el-input v-model=\"formData.fInstructionName\" placeholder=\"请输入内容\" v-bind:disabled=\"active != 1? true : false\"></el-input>\n        </el-col>\n        <el-col :span=\"4\" class=\"from-col-left\" >\n          调度指令下达时间\n        </el-col>\n        <el-col :span=\"8\" style=\"text-align: center ;line-height: 40px;\">\n          <el-date-picker v-model=\"formData.fInstructionTime\" type=\"date\" style=\"width: 50%;\" format=\"yyyy 年 MM 月 dd日\" placeholder=\"指令下达时间\" v-bind:disabled=\"active != 1? true : false\">\n          </el-date-picker>\n        </el-col>\n      </el-row>\n\n      <el-row  class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-col\" >\n          调度指令说明\n        </el-col>\n        <el-col :span=\"21\" style=\"height: 50px;\">\n          <el-input type=\"textarea\" maxlength=\"500\" show-word-limit  :rows=\"4\" placeholder=\"请输入内容\" v-model=\"formData.fInstructionContent\" v-bind:disabled=\"active != 1? true : false\">\n          </el-input>\n        </el-col>\n      </el-row>\n\n      <el-row  class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-col\" style=\"line-height: 100px;\" >\n          调度单上传\n        </el-col>\n        <el-col :span=\"9\" style=\"height: 100px; border-right: #a4d5ff 1px solid;\">\n          <div  style=\"width: 300px;margin-top: 20px;margin-left: 20px;\">\n            <el-upload style=\"margin-left: 15px;margin-top: 15px\" class=\"upload-demo\"\n                       :headers=\"GLOBAL.headers()\"\n                       :action=\"GLOBAL.httpUrl\"\n                       :on-preview=\"handlePreview\" :on-remove=\"handleRemove\"  multiple\n                       :on-success=\"uploadedSuccess\"\n                       :show-file-list=\"true\"\n                       :auto-upload=\"true\"\n                       :limit=\"1\"\n                       :disabled=\"active != 1\"\n                       :on-exceed=\"handleExceed\" :file-list=\"fileList\">\n              <el-button size=\"small\" type=\"primary\" :disabled=\"active != 1\">调度单上传</el-button>\r\n\t\t\t  <div slot=\"tip\" class=\"el-upload__tip\" style=\"margin-top: 15px\">上传文件不得超过100M</div>\n            </el-upload>\n          </div>\n        </el-col>\n        <el-col :span=\"3\" class=\"from-col\" style=\"line-height: 100px;\">\n          操作票上传\n        </el-col>\n        <el-col :span=\"9\" style=\"height: 50px;\">\n          <div  style=\"width: 300px;margin-top: 20px;margin-left: 20px;\">\n            <el-upload style=\"margin-left: 15px;margin-top: 15px\" class=\"upload-demo\"\n                       :headers=\"GLOBAL.headers()\"\n                       :action=\"GLOBAL.httpUrl\"\n                       :on-preview=\"handlePreviewa\" :on-remove=\"operationTicketRemove\"  multiple\n                       :on-success=\"operationTicket\"\n                       :show-file-list=\"true\"\n                       :auto-upload=\"true\"\n                       :limit=\"1\"\n                       :disabled=\"active != 1\"\n                       :on-exceed=\"handleExceed\" :file-list=\"fileList1\">\n              <el-button size=\"small\" type=\"primary\" :disabled=\"active != 1\">操作票上传</el-button>\r\n\t\t\t  <div slot=\"tip\" class=\"el-upload__tip\" style=\"margin-top: 15px\">上传文件不得超过100M</div>\n            </el-upload>\n          </div>\n        </el-col>\n      </el-row>\n      <el-row class=\"from-border-bottom\" style=\"text-align: right;margin-right: 10px;\">\n        <div style=\"margin-top:10px;margin-bottom:10px;\">\n          编制人：<el-input v-model=\"formData.fPreparedBy\"  placeholder=\"请输入内容\" style=\"width:220px;border: 1px solid #DCDFE6;\" :disabled=\"active != 1\"></el-input>\n          <div class=\"block\" style=\"display:inline;margin-left: 15px\">\n                <span class=\"demonstration\" v-html=\"'时&ensp;&ensp;间：'\"/>\n                <el-date-picker style=\"border: 1px solid #DCDFE6;\"\n                  type=\"date\"\n                  v-model=\"formData.fPreparationTime\"\n                  placeholder=\"选择日期\"\n                  format=\"yyyy 年 MM 月 dd 日\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\"\n                  :disabled=\"active != 1\"\n                  >\n                </el-date-picker>\n              </div>\n        </div>\n\n      </el-row>\n\n      <el-row  class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-col\" style=\"line-height: 400px;min-height:400px\">\n          调度指令执行\n        </el-col>\n        <el-col :span=\"21\" >\n          <el-button size=\"small\" type=\"primary\" style=\"margin:5px;float:right;margin-right:15px;\"\r\n            @click=\"addRun\" v-if=\"active == 2\">执行记录</el-button>\n            <div class=\"table-head\" style=\"width:98%;margin:0 auto;margin-top:40px;\">\n               调度指令执行列表\n            </div>\n          <el-table :data=\"tableData\" border style=\"width:98%;margin:0 auto;\">\n<!--            <el-table-column label=\"序号\" align=\"center\" width=\"70\" type=\"index\" />-->\n            <el-table-column label=\"执行时间\" align=\"center\" width=\"190\" prop=\"fRunTime\" />\n            <el-table-column label=\"结束时间\" align=\"center\" width=\"190\" prop=\"fEndTime\" />\n            <el-table-column label=\"执行情况描述\" align=\"center\" width=\"200\" prop=\"fRunContent\" />\n            <el-table-column label=\"存在问题\" align=\"center\" width=\"180\" prop=\"fProblem\" />\n            <el-table-column label=\"问题处置\" align=\"center\" width=\"180\" prop=\"fProblemHandle\" >\n              <template slot-scope=\"{row}\">\n                <span v-for=\"(item,index) in dict.problemDisposal\"  v-if=\"row.fProblemHandle == item.dictValue\">{{item.dictLabel}}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"执行人\" align=\"center\" prop=\"fRunPersion\" />\n            <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"180\">\n              <template slot-scope=\"{row}\">\n<!--                <el-button size=\"mini\" type=\"text\" :disabled=\"active != 2\">查看</el-button>-->\n                <el-button size=\"mini\" type=\"text\" :disabled=\"active != 2\" @click=\"edit(row)\">编辑</el-button>\n                <el-button size=\"mini\" type=\"text\" :disabled=\"active != 2\" @click=\"del(row)\">删除</el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"from-border-bottom\" >\n        <el-col :span=\"3\"  class=\"from-col\" >\n          执行结果反馈\n        </el-col>\n        <el-col :span=\"9\" class=\"from-col\" >\n          <el-input type=\"textarea\" maxlength=\"500\" show-word-limit  :rows=\"7\" placeholder=\"请输入内容\" v-model=\"formData.fRunResult\" :disabled=\"active != 3\"></el-input>\n        </el-col>\n        <el-col :span=\"4\"  class=\"from-col\" >\n          执行结果反馈附件\n        </el-col>\n        <el-col :span=\"8\" style=\"height: 50px;\">\n          <div  style=\"width: 300px;margin-top: 20px;margin-left: 20px;\">\n            <el-upload style=\"margin-left: 15px;margin-top: 15px\" class=\"upload-demo\"\n                       :headers=\"GLOBAL.headers()\"\n                       :action=\"GLOBAL.httpUrl\"\n                        :before-upload = \"beforeAvatarUpload\"\n                       :on-preview=\"handlePreviewb\" :on-remove=\"executionResultRemove\"  multiple\n                       :on-success=\"executionResult\"\n                       :show-file-list=\"true\"\n                       :auto-upload=\"true\"\n                       :limit=\"1\"\n                       :disabled=\"active != 3\"\n                       :on-exceed=\"handleExceed\" :file-list=\"fileList2\">\n              <el-button size=\"small\" type=\"primary\" :disabled=\"active != 3\">执行结果上传</el-button>\r\n\t\t\t  <div slot=\"tip\" class=\"el-upload__tip\" style=\"margin-top: 15px\">上传文件不得超过100M</div>\n            </el-upload>\n          </div>\n        </el-col>\n      </el-row>\n      <el-row class=\"from-border-bottom\" style=\"text-align: right;margin-right: 10px;\">\n        <div style=\"margin-top:10px;margin-bottom:10px;\">\n          反馈人：<el-input v-model=\"formData.fReportPersion\"  placeholder=\"请输入内容\" style=\"width:220px;border: 1px solid #DCDFE6;\" :disabled=\"active != 3\"></el-input>\n          <div class=\"block\" style=\"display:inline;margin-left: 15px\">\n                <span class=\"demonstration\" v-html=\"'时&ensp;&ensp;间：'\"/>\n                <el-date-picker style=\"border: 1px solid #DCDFE6;\"\n                  type=\"date\"\n                  v-model=\"formData.fReportTime\"\n                  placeholder=\"选择日期\"\n                  format=\"yyyy 年 MM 月 dd 日\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\"\n                  :disabled=\"active != 3\"\n                  >\n                </el-date-picker>\n              </div>\n        </div>\n\n      </el-row>\n\n\n\n    </div>\n    <!-- 执行记录 -->\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"800px\" append-to-body @close=\"cancel\">\n      <el-form ref=\"form\" :model=\"form\"  :inline=\"true\" class=\"demo-form-inline\">\n\n            <el-form-item label=\"执行时间\" prop=\"\">\n                <el-date-picker style=\"width:  200px\" v-model=\"form.fRunTime\"  placeholder=\"执行时间\" format=\"yyyy 年 MM 月 dd 日\" value-format=\"yyyy-MM-dd HH:mm:ss\"></el-date-picker>\n            </el-form-item>\n\n            <el-form-item label=\"结束时间\" prop=\"\">\n                <el-date-picker style=\"width:  200px\" v-model=\"form.fEndTime\"  placeholder=\"结束时间\" format=\"yyyy 年 MM 月 dd 日\" value-format=\"yyyy-MM-dd HH:mm:ss\"></el-date-picker>\n            </el-form-item>\n\n            <el-form-item label=\"问题处置\" prop=\"\">\n                <el-select style=\"width:  200px\" v-model=\"form.fProblemHandle\" placeholder=\"请选择问题处置\">\n                  <el-option v-for=\"item in dict.problemDisposal\" :key=\"item.dictValue\" :label=\"item.dictLabel\" :value=\"item.dictValue\">\n                </el-option>\n              </el-select>\n            </el-form-item>\n\n            <el-form-item label=\"执行人\" prop=\"\">\n              <el-input style=\"width:  200px\" v-model=\"form.fRunPersion\" placeholder=\"请输入执行人名称\" maxlength=\"50\" />\n            </el-form-item>\n\n        <el-form-item label=\"存在问题\">\n          <el-input style=\"width: 510px\"  maxlength=\"500\" show-word-limit  v-model=\"form.fProblem\" :autosize=\"{ minRows: 4, maxRows: 6}\" type=\"textarea\"  placeholder=\"请输入存在问题\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"情况描述\">\n          <el-input style=\"width: 510px\"  maxlength=\"500\" show-word-limit  v-model=\"form.fRunContent\" :autosize=\"{ minRows: 4, maxRows: 6}\" type=\"textarea\"  placeholder=\"请输入描述内容\"></el-input>\n        </el-form-item>\n\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"cancel\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\n      </div>\n    </el-dialog>\n\n<!--    <el-dialog-->\n<!--      title=\"选择处理人\"-->\n<!--      :visible.sync=\"dialogVisible\"-->\n<!--      :modal=\"false\"-->\n<!--      width=\"30%\">-->\n<!--      <el-radio v-model=\"formData.fActPersion\" :label=\"item.userId\" v-for=\"(item,index) in userList\" :key=\"index\">-->\n<!--        {{ item.nickName }}-->\n<!--      </el-radio>-->\n<!--      <span slot=\"footer\" class=\"dialog-footer\">-->\n<!--        <el-button @click=\"dialogVisible = false\">取 消</el-button>-->\n<!--        <el-button type=\"primary\" @click=\"addAndUpdate\">确 定</el-button>-->\n<!--      </span>-->\n<!--    </el-dialog>-->\n\n  </div>\n</template>\n<script>\n\nimport { getToken } from \"@/utils/auth\";\nimport {\n  getUserList\n} from \"@/api/security/planning\";\n\nimport {\n  dataQuery\n} from \"@/api/indemnification/training\";\n\nimport { addInstruction, updateInstruction } from \"@/api/dispatch/instruction\"\n\nimport { listLog, addLog, updateLog, delLog } from \"@/api/dispatch/log\"\n\nexport default {\n\n    data() {\n      return {\n\n        title: '',\n\n        // 文件上传\n        // upload: {\n        //   // 设置上传的请求头部\n        //   headers: {Authorization: \"Bearer \" + getToken()},\n        //   // 上传的地址\n        //   url: process.env.VUE_APP_BASE_API + \"/file/upload\"\n        // },\n        userList: [],\n\n        // dialogVisible: false,\n\n        active:1,\n\n        info: {\n          stockDate:this.getNowTime(),  //日期\n        },\n\n        open: false,\n\n        dict: {\n          problemDisposal: []\n        },\n\n        fileList: [],\n        fileList1: [],\n        fileList2: [],\n\n        tableData: [],\n\n        formData: {\n          /** id */\n          fId: null,\n\n          /** 调度指令名称 */\n          fInstructionName: null,\n\n          /** 调度指令下达时间 */\n          fInstructionTime: null,\n\n          /** 调度指令说明 */\n          fInstructionContent: null,\n\n          /** 调度单附件 */\n          fSchedulingId: null,\n\n          /** 操作票附件 */\n          fOperateId: null,\n\n          /** 编制人 */\n          fPreparedBy: null,\n\n          /** 编制时间 */\n          fPreparationTime: null,\n\n          /** 执行结果 */\n          fRunResult: null,\n\n          /** 执行结果附件 */\n          fResultUrl: null,\n\n          /** 执行结果反馈人 */\n          fReportPersion: null,\n\n          /** 反馈时间 */\n          fReportTime: null,\n\n          /** 指令执行状态 0:指令接收 1:指令执行2：指令反馈 */\n          fInstructionStatus: null,\n\n          /** 状态 0:无效1：有效 */\n          fStatus: null,\n\n          /** 创建人 */\n          fCreatePeople: null,\n\n          /** 创建时间 */\n          fCreateTime: null,\n\n          /** 流程实例id */\n          fActId: null,\n\n          // /** 流程下一环节审核人 */\n          // fActPersion: null,\n\n          /** 流程状态 1已提交启动 2：审核中 3：驳回 4：审核完成 */\n          fActStatus: null,\n\n          /** 流程节点 */\n          fActNode: null,\n\n          /**\n           * 暂存或提交 1提交 0暂存\n           */\n          holdOrSubmit: null,\n\n          /**\n           * 当前登陆人\n           */\n          landingPersonId: null\n\n        },\n\n        form: {\n          /** id */\n          fLogId: null,\n\n          /** 调度指令表ID */\n          fInstructionId: null,\n\n          /** 执行情况描述 */\n          fRunContent: null,\n\n          /** 存在问题 */\n          fProblem: null,\n\n          /** 问题处置 */\n          fProblemHandle: null,\n\n          /** 执行人 */\n          fRunPersion: null,\n\n          /** 执行时间 */\n          fRunTime: null,\n\n          /** 结束时间 */\n          fEndTime: null\n        }\n\n      };\n    },\n    created() {\n      this.Personnel();\n      this.dataQuery()\n    },\n    methods: {\n      beforeAvatarUpload(file){\n      const isLt100M = file.size / 1024 / 1024 < 100;\n         if (!isLt100M) {\n                this.$message.error('上传文件大小不能超过 100MB!');\n                return false\n            }\n      },\n\n      init(data, type, file, file1, file2) {\n        this.fileList2 = []\n        this.active = data.fActStatus\n        this.formData = data\n        if (file) {\n          this.fileList = [{name: file.fOldFileName, url: file.fFilePath}]\n        }\n        if (file1) {\n          this.fileList1 = [{name: file1.fOldFileName, url: file1.fFilePath}]\n        }\n        if (file2 && file2.fFilePath) {\n          this.fileList2 = [{name: file2.fOldFileName, url: file2.fFilePath}]\n        }\n        if (type == 1) {\n          this.getList()\n        }\n      },\n\n      submit(type) {\n        if (this.active == 1) {\n          if (this.formData.fInstructionName == null) {\n            this.$message.error(\"请填写调度指令名称\")\n            return false\n          } else if (this.formData.fInstructionTime == null) {\n            this.$message.error(\"请选择调度指令下达时间\")\n            return false\n          } else if (this.formData.fInstructionContent == null) {\n            this.$message.error(\"请填写调度指令说明\")\n            return false\n          } else if (this.formData.fSchedulingId == null) {\n            this.$message.error(\"请上传经费用途文件\")\n            return false\n          } else if (this.formData.fOperateId == null) {\n            this.$message.error(\"请上传操作票附件\")\n            return false\n          } else if (this.formData.fPreparedBy == null) {\n            this.$message.error(\"请填写编制人\")\n            return false\n          } else if (this.formData.fPreparationTime == null) {\n            this.$message.error(\"请选择编制时间\")\n            return false\n          }\n          this.formData.holdOrSubmit = type\n          // if (type == 1) {\n          //   this.dialogVisible = true;\n          // } else {\n            this.addAndUpdate()\n          // }\n        }\n      },\n\n      // 调度指令执行\n      execution() {\n        if (this.tableData.length <= 0) {\n          this.$message.error(\"请添加执行记录\");\n          return false\n        }\n        // this.dialogVisible = true\n        this.addAndUpdate()\n      },\n\n      // 执行结果反馈\n      report() {\n        if (this.active == 3) {\n          if (this.formData.fRunResult == null) {\n            this.$message.error(\"请填写执行结果\")\n            return false\n          } else if (this.formData.fResultUrl == null) {\n            this.$message.error(\"请上传执行结果反馈附件\")\n            return false\n          } else if (this.formData.fReportPersion == null) {\n            this.$message.error(\"请填写审批人\")\n            return false\n          } else if (this.formData.fReportTime == null) {\n            this.$message.error(\"请选择审批时间\")\n            return false\n          }\n          this.addAndUpdate()\n        }\n      },\n\n      addAndUpdate() {\n\n        // if (this.formData.holdOrSubmit == 1) {\n        //   if (this.formData.fActPersion == null) {\n        //     this.$message.error(\"请选择流程下一环节审核人\")\n        //     return false\n        //   }\n        // }\n        if (this.formData.fId != null && this.formData.fId != '') {\n          updateInstruction(this.formData).then(res => {\n            if (res.code == 200) {\n              this.$message.success(\"调度成功\");\n              // this.dialogVisible = false\n              // 调用父组件方法关闭弹窗\n              this.$emit(\"shut\", false)\n              // 调用父组件方法查询列表\n              this.$emit(\"search\")\n            } else {\n              this.$message.error(\"调度失败\");\n            }\n          });\n        } else {\n          addInstruction(this.formData).then(res => {\n            if (res.code == 200) {\n              if (this.formData.holdOrSubmit == 1) {\n                this.$message.success(\"调度指令提交成功\");\n              } else {\n                this.msgSuccess(\"调度指令暂存成功\");\n              }\n              this.clearForm();\n              // this.dialogVisible = false\n            } else {\n              if (this.formData.holdOrSubmit == 1) {\n                this.$message.error(\"调度指令提交失败\");\n              } else {\n                this.msgError(\"调度指令暂存失败\");\n              }\n            }\n          });\n        }\n      },\n\n      Personnel() {\n        getUserList().then(response => {\n          this.userList = response.data\n        })\n      },\n\n      addRun() {\n        this.open = true;\n        this.title = '新增执行记录'\n      },\n\n      cancel() {\n        this.open = false;\n        this.remove()\n      },\n\n      // 调度指令执行列表保存\n      submitForm() {\n        if (this.form.fLogId != null && this.form.fLogId != '') {\n          updateLog(this.form).then(result => {\n            if (result.code == 200) {\n              this.$message.success(\"调度指令执行修改成功\");\n              this.open = false\n              this.remove()\n              this.getList()\n            } else {\n              this.$message.error(\"调度指令执行修改失败\")\n            }\n          });\n        } else {\n          this.form.fInstructionId = this.formData.fId\n          addLog(this.form).then(result => {\n            if (result.code == 200) {\n              this.$message.success(\"调度指令执行保存成功\");\n              this.open = false\n              this.remove()\n              this.getList()\n            } else {\n              this.$message.error(\"调度指令执行保存失败\");\n            }\n          });\n        }\n      },\n\n      // 编辑调度指令执行\n      edit(row) {\n        this.title = '修改执行记录'\n        this.form = row\n        this.open = true\n      },\n\n      // 调度指令执行删除\n      del(row) {\n        this.$confirm('是否确认删除档案分类 编号为\"' + row.fLogId + '\"的数据项?', \"警告\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(function() {\n          return delLog(row.fLogId);\n        }).then(() => {\n          this.getList();\n          this.msgSuccess(\"删除成功\");\n        }).catch(() => {});\n      },\n\n      // 获取调度指令执行列表\n      getList() {\n        var queryParams = {\n          fInstructionId : this.formData.fId\n        }\n        listLog(queryParams).then(result => {\n          this.tableData = result.rows\n        });\n      },\n\n      dataQuery() {\n        var query = { dictType: 'problemDisposal' }\n        dataQuery(query).then(res => {\n          if (res.code == 200) {\n            this.dict.problemDisposal = res.data\n          }\n        });\n      },\n\n      // 调度单附件上传成功\n      uploadedSuccess(response, file, fileList) {\n        this.formData.fSchedulingId = response.data.fId\n        this.fileList = [{\n          name:response.data.fOldFileName,\n          url:response.data.fFilePath\n        }]\n      },\n\n      // 操作票上传成功\n      operationTicket(response, file, fileList) {\n        this.formData.fOperateId = response.data.fId\n        this.fileList1 = [{\n          name:response.data.fOldFileName,\n          url:response.data.fFilePath\n        }]\n      },\n\n      // 执行结果上传成功\n      executionResult(response, file, fileList) {\n        this.formData.fResultUrl = response.data.fId\n        this.fileList2 = [{\n          name:response.data.fOldFileName,\n          url:response.data.fFilePath\n        }]\n      },\n\n      // 调度单附件删除成功\n      handleRemove(file, fileList) {\n        this.GLOBAL.commonFun(this.formData.fSchedulingId)\n      },\n\n      // 操作票删除成功\n      operationTicketRemove() {\n        this.GLOBAL.commonFun(this.formData.fOperateId)\n      },\n\n      // 执行结果删除成功\n      executionResultRemove() {\n        this.GLOBAL.commonFun(this.formData.fResultUrl)\n      },\n\n\n      handlePreview(file) {\n        console.log(file);\r\n\t\t// window.location.href = file.url;\r\n\t\twindow.open(this.fileList[0].url);\n      },\n      handlePreviewa(file){\n        window.open(this.fileList1[0].url);\n      },\n      handlePreviewb(file){\n        window.open(this.fileList2[0].url);\n      },\n      handleExceed(files, fileList) {\n        this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);\n      },\n      beforeRemove(file, fileList) {\n        return this.$confirm(`确定移除 ${ file.name }？`);\n      },\n      \t    getNowTime() {\n\t       var now = new Date();\n\t       var year = now.getFullYear(); //得到年份\n\t       var month = now.getMonth(); //得到月份\n\t       var date = now.getDate(); //得到日期\n\t       var hour =\" 00:00:00\"; //默认时分秒 如果传给后台的格式为年月日时分秒，就需要加这个，如若不需要，此行可忽略\n\t       month = month + 1;\n\t       month = month.toString().padStart(2, \"0\");\n\t       date = date.toString().padStart(2, \"0\");\n\t       var defaultDate = `${year}-${month}-${date}${hour}`;\n\t       console.log(defaultDate)\n\t       return defaultDate;\n\t       this.$set(this.info, \"stockDate\", defaultDate);\n\t    },\n\n\n      clearForm() {\n        this.formData = {\n          /** id */\n          fId: null,\n\n          /** 调度指令名称 */\n          fInstructionName: null,\n\n          /** 调度指令下达时间 */\n          fInstructionTime: null,\n\n          /** 调度指令说明 */\n          fInstructionContent: null,\n\n          /** 调度单附件 */\n          fSchedulingId: null,\n\n          /** 操作票附件 */\n          fOperateId: null,\n\n          /** 编制人 */\n          fPreparedBy: null,\n\n          /** 编制时间 */\n          fPreparationTime: null,\n\n          /** 执行结果 */\n          fRunResult: null,\n\n          /** 执行结果附件 */\n          fResultUrl: null,\n\n          /** 执行结果反馈人 */\n          fReportPersion: null,\n\n          /** 反馈时间 */\n          fReportTime: null,\n\n          /** 指令执行状态 0:指令接收 1:指令执行2：指令反馈 */\n          fInstructionStatus: null,\n\n          /** 状态 0:无效1：有效 */\n          fStatus: null,\n\n          /** 创建人 */\n          fCreatePeople: null,\n\n          /** 创建时间 */\n          fCreateTime: null,\n\n          /** 流程实例id */\n          fActId: null,\n\n          // /** 流程下一环节审核人 */\n          // fActPersion: null,\n\n          /** 流程状态 1已提交启动 2：审核中 3：驳回 4：审核完成 */\n          fActStatus: null,\n\n          /** 流程节点 */\n          fActNode: null,\n\n          /**\n           * 暂存或提交 1提交 0暂存\n           */\n          holdOrSubmit: null,\n\n          /**\n           * 当前登陆人\n           */\n          landingPersonId: null\n        }\n\n        this.fileList = []\n        this.fileList1 = []\n\n      },\n\n      remove() {\n        this.form = {\n          /** id */\n          fLogId: null,\n\n          /** 调度指令表ID */\n          fInstructionId: null,\n\n          /** 执行情况描述 */\n          fRunContent: null,\n\n          /** 存在问题 */\n          fProblem: null,\n\n          /** 问题处置 */\n          fProblemHandle: null,\n\n          /** 执行人 */\n          fRunPersion: null,\n\n          /** 执行时间 */\n          fRunTime: null,\n\n          /** 结束时间 */\n          fEndTime: null\n        }\n      }\n\n    }\n  };\n</script>\n<style lang=\"scss\" >\n  .color409 {\n    color: #409eff;\n    cursor: pointer;\n  }\n  .instructionReceived{\n    .el-upload-list{\n      margin-left: 120px;\n      margin-top: -60px;\n    }\n  }\n\n</style>\n"]}]}