{"remainingRequest":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\src\\views\\runManagement\\annual\\annualEstablishment.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\src\\views\\runManagement\\annual\\annualEstablishment.vue","mtime":1640419131371},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":1711181251489},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1711181253421},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":1711181252308},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1711181250722},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711181250741},{"path":"D:\\GraduationProject\\final\\reservioir\\reservioir-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1711181252689}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jb2xvcjQwOSB7CiAgY29sb3I6ICM0MDllZmY7CiAgY3Vyc29yOiBwb2ludGVyOwp9Cg=="},{"version":3,"sources":["annualEstablishment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAubA;AACA;AACA;AACA","file":"annualEstablishment.vue","sourceRoot":"src/views/runManagement/annual","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-row class=\"from-top\">\n      <el-col :span=\"24\">\n        <div style=\"margin: 0 auto;display: flex;align-items: center;width: 100%;justify-content:center;\">\n          <div style=\"position: relative;\">\n            <img src=\"../../../assets/images/jin.png\" />\n            <div style=\"position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;\">1.编制</div>\n          </div>\n          <div style=\"position: relative;\">\n            <img :src=\"require(active>1? '../../../assets/images/jin.png':'../../../assets/images/jin1.png')\" />\n            <div :style=\"active>1? 'position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;':'position: absolute;top: 10px;left: 100px;width: 50%;color: #757575;'\">\n              2.审核</div>\n          </div>\n          <div style=\"position: relative;\">\n            <img :src=\"require(active>=3? '../../../assets/images/jin.png':'../../../assets/images/jin1.png')\" />\n            <div :style=\"active>1? 'position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;':'position: absolute;top: 10px;left: 100px;width: 50%;color: #757575;'\">\n              3.审批</div>\n          </div>\n          <div style=\"position: relative;\">\n            <img :src=\"require(active==4? '../../../assets/images/jin.png':'../../../assets/images/jin1.png')\" />\n            <div :style=\"active>1? 'position: absolute;top: 10px;left: 100px;width: 50%;color: #FFFFFF;':'position: absolute;top: 10px;left: 100px;width: 50%;color: #757575;'\">\n              4.完成</div>\n          </div>\n        </div>\n      </el-col>\n\n    </el-row>\n    <div class=\"from-div\">\n      <el-row>\n        <el-col :span=\"24\" class=\"from-div-title\" style=\"background-color: rgba(215, 215, 215, 1); text-align: right;\">\n          <div style=\"margin-right: 10px\">\n            <el-button type=\"primary\" size=\"small\" @click=\"handleAdd\">暂存</el-button>\n            <el-button type=\"primary\" size=\"small\" @click=\"submitForm\">提交</el-button>\n          </div>\n        </el-col>\n      </el-row>\n\n      <el-row>\n        <el-col :span=\"24\" class=\"from-div-title\">\n          年度调度编制表\n        </el-col>\n      </el-row>\n      <el-row class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-col-left\">\n          调度名称\n        </el-col>\n        <el-col :span=\"8\" class=\"from-border-right\">\n          <el-input v-model=\"rControl.fDispatchName\" placeholder=\"请输入内容\"></el-input>\n        </el-col>\n        <el-col :span=\"3\" class=\"from-col-left\">\n          调度类型\n        </el-col>\n        <el-col :span=\"3\" style=\"line-height: 40px;border-right: #a4d5ff 1px solid;\">\n          <div>\n            <el-select v-model=\"rControl.fDispatchType\" placeholder=\"请选择\">\n              <el-option v-for=\"item in audit.planType\" :key=\"item.dictValue\" :label=\"item.dictLabel\" :value=\"item.dictValue\">\n              </el-option>\n            </el-select>\n          </div>\n        </el-col>\n\n        <el-col :span=\"3\" class=\"from-col-left\">\n          预算（元）\n        </el-col>\n        <el-col :span=\"4\" class=\"from-border-right\">\n          <el-input v-model=\"rControl.fBudget\" placeholder=\"预算（元）\"></el-input>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-borderibht\">\n          调度内容\n        </el-col>\n        <el-col :span=\"21\" style=\"height: 400px;\">\n          <div style=\"font-size: 16px;font-weight: 700;padding: 10px;\">\n            调度概述：\n          </div>\n          <el-input  maxlength=\"500\" show-word-limit  type=\"textarea\" :rows=\"8\" placeholder=\"请输入内容\" v-model=\"rControl.fDispatchContent\">\n          </el-input>\n          <div style=\"display:flex;justify-content:space-between;margin-top: 100px;\">\n            <div style=\"width: 200px;margin-top: -60px;margin-left: 20px;\">\n              <el-upload style=\"margin-left: 15px;margin-top: 15px\" class=\"upload-demo\" :headers=\"GLOBAL.headers()\"\n                :action=\"GLOBAL.httpUrl\" :on-preview=\"handlePreview\" :on-remove=\"handleRemove\" \n                multiple :on-success=\"uploadedSuccess\" :show-file-list=\"true\" :auto-upload=\"true\" :limit=\"1\" :on-exceed=\"handleExceed\"\n                :file-list=\"fileList\" :before-upload = \"beforeAvatarUpload\" data-type = \"\">\n                <el-button size=\"small\" type=\"primary\">上传附件</el-button>\n                <div slot=\"tip\" class=\"el-upload__tip\" style=\"margin-top: 15px\">上传文件不得超过100M</div>\n              </el-upload>\n            </div>\n            <div style=\"font-size: 20px;margin-right: 10px;margin-top: -5px;\">\n              <div style=\"text-align: left\">\n                <div style=\"display:inline;\">编制人：<el-input v-model=\"rControl.fEditPersion\" placeholder=\"请输入内容\" style=\"width:220px;border: 1px solid #DCDFE6;\"></el-input>\n                </div>\n                <div class=\"block\" style=\"transform:translateY(10%)\">\n                  <span class=\"demonstration\" v-html=\"'时&ensp;&ensp;间：'\" />\n                  <el-date-picker type=\"date\" style=\"border: 1px solid #DCDFE6;\" v-model=\"rControl.fEditTime\"\n                    placeholder=\"选择日期\" format=\"yyyy 年 MM 月 dd 日\" value-format=\"yyyy-MM-dd HH:mm:ss\">\n                  </el-date-picker>\n                </div>\n              </div>\n            </div>\n          </div>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-col\">\n          调度审核\n        </el-col>\n        <el-col :span=\"21\" style=\"height: 50px;\">\n          <div style=\"font-size: 16px;font-weight: 700;padding: 10px;\">\n            审核意见：\n          </div>\n          <el-input  maxlength=\"500\" show-word-limit  disabled type=\"textarea\" :rows=\"3\" v-model=\"rControl.fAuditContent\" placeholder=\"请输入内容\">\n          </el-input>\n          <div class=\"from-select\">\n            <div style=\"margin-left: 10px;\">\n              <div style=\"font-size: 16px;font-weight: 700;display:inline;\">\n                审核结果：\n              </div>\n              <el-select disabled v-model=\"rControl.fAuditResult\" clearable placeholder=\"请选择\">\n                <el-option disabled v-for=\"item in audit.sysResult\" :key=\"item.dictValue\" :label=\"item.dictLabel\"\n                  :value=\"item.dictValue\">\n                </el-option>\n              </el-select>\n            </div>\n            <div>\n              <span>审核人：<el-input disabled v-model=\"rControl.fAuditPersion\" placeholder=\"请输入内容\" style=\"width:180px;\">\n                </el-input>\n              </span>\n              <div class=\"block\" style=\"display:inline;margin-left:10px;\">\n                <span class=\"demonstration\" v-html=\"'时&ensp;&ensp;间：'\" />\n                <el-date-picker disabled type=\"date\" v-model=\"rControl.fAuditTime\" placeholder=\"选择日期\" format=\"yyyy 年 MM 月 dd 日\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\">\n                </el-date-picker>\n              </div>\n            </div>\n          </div>\n        </el-col>\n      </el-row>\n\n      <el-row class=\"from-border-bottom\">\n        <el-col :span=\"3\" class=\"from-col\">\n          调度批准\n        </el-col>\n        <el-col :span=\"21\" style=\"height: 50px;\">\n          <div style=\"font-size: 16px;font-weight: 700;padding: 10px;\">\n            审批意见：\n          </div>\n          <el-input  maxlength=\"500\" show-word-limit  type=\"textarea\" disabled :rows=\"3\" v-model=\"rControl.fApproveContent\" placeholder=\"请输入内容\">\n          </el-input>\n          <div class=\"from-select\">\n            <div style=\"margin-left: 10px;\">\n              <div style=\"font-size: 16px;font-weight: 700;display:inline;\">\n                审批结果：\n              </div>\n              <el-select disabled v-model=\"rControl.fApproveResult\" clearable placeholder=\"请选择\">\n                <el-option disabled v-for=\"item in audit.sysResult\" :key=\"item.dictValue\" :label=\"item.dictLabel\"\n                  :value=\"item.dictValue\">\n                </el-option>\n              </el-select>\n            </div>\n            <div>\n              <span>审批人：<el-input disabled v-model=\"rControl.fApprovePersion\" placeholder=\"请输入内容\" style=\"width:180px;\">\n                </el-input>\n              </span>\n              <div class=\"block\" style=\"display:inline;margin-left:10px;\">\n                <span class=\"demonstration\" v-html=\"'时&ensp;&ensp;间：'\" />\n                <el-date-picker disabled type=\"dates\" v-model=\"rControl.fApproveTime\" placeholder=\"选择日期\" format=\"yyyy 年 MM 月 dd 日\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\">\n                </el-date-picker>\n              </div>\n            </div>\n          </div>\n        </el-col>\n      </el-row>\n    </div>\n\n    <!-- 下一流程 处理人 弹窗 -->\n    <el-dialog\n      title=\"选择处理人\"\n      :visible.sync=\"nextVisible\"\n      width=\"700px\"\n      :before-close=\"handleClose\">\n      <el-radio v-model=\"radio\" :label=\"item.userId\" v-for=\"(item,index) in list\" :key=\"index\">{{item.nickName}}</el-radio>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"nextVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addSubmits\">确 定</el-button>\n      </span>\n    </el-dialog>\n\n  </div>\n</template>\n<script>\n  import {\n    planDataQuery\n  } from \"@/api/emergency/emergency\";\n  import {\n    listControl,\n    getControl,\n    delControl,\n    addControl,\n    updateControl,\n    startWorkFlow,\n    taskReview,\n    latelyControl,\n    getDictByType\n  } from \"@/api/reservoir/annualEstablishment\";\n  import {\n    getUserList,\n  } from \"@/api/security/planning\";\n  import {\n    getToken\n  } from \"@/utils/auth\";\n  import {\n    getFileById\n  } from \"@/api/file\";\n  export default {\n\n    data() {\n      return {\n        userList: [],\n        nextVisible: false,\n        form: {},\n        rControl: {\n          //年度计划名称\n          fDispatchName:'',\n          //年度计划类型\n          fDispatchType:'',\n          //预算\n          fBudget:'',\n\n          //计划概述\n          fDispatchContent:'',\n          //年度计划附件\n          fDispatchId:'',\n          //编制人\n          fEditPersion:'',\n          //编制时间\n          fEditTime:'',\n\n          //审核意见\n          fAuditContent:'',\n          //审核结果\n          fAuditResult:'',\n          //审核人\n          fAuditPersion:'',\n          //审核时间\n          fAuditTime:'',\n\n          //审批意见\n          fApproveContent:'',\n          //审批结果\n          fApproveResult:'',\n          //审批人\n          fApprovePersion:'',\n          //审批时间\n          fApproveTime:'',\n\n          //流程实例ID\n          fActId:'',\n          //下一节点审核人\n          fActPersion:'',\n          //流程状态 1已提交启动 2：批准中 3：发布 4：发布完成 5：驳回 6：不同意删除\n          fActStatus:'',\n          //流程节点\n          fActNode:'',\n\n          //创建人\n          fCreateBy:'',\n          //创建时间\n          fCreateTime:'',\n        },\n        active: 1,\n        textarea: '',\n        textarea1: '',\n        textarea2: '',\n        fileList: [],\n        audit: [],\n      };\n    },\n    created() {\n      this.Personnel();\n      this.getDitc();\n      this.getLatelyControl()\n    },\n    methods: {\n      beforeAvatarUpload(file){\n      const isLt100M = file.size / 1024 / 1024 < 100;\n         if (!isLt100M) {\n                this.$message.error('上传文件大小不能超过 100MB!');\n                return false\n            }\n      },\n\n      getFile() {\n        console.log('fileList = []');\n        this.fileList = [];\n        if (this.rControl.fDispatchId) {\n          getFileById({\n            id: this.rControl.fDispatchId\n          }).then(result => {\n            if (result) {\n              this.fileList = [{\n                name: result.data.fOldFileName,\n                url: result.data.fFilePath\n              }];\n              console.log(\"fileList.url:\", this.fileList[0].url);\n            }\n          })\n        }\n      },\n      init() {\n        console.log('初始化')\n        if( this.status == 1 ) {\n          console.log('初始化',this.emergencyPass)\n\n          //查询是否 为暂存\n          if(this.rControl.fActStatus == 0) {\n            this.active = 1\n            console.log(\"为暂存\")\n          }\n          //查询是否  为待审核\n          else if(this.rControl.fActStatus == 1){\n            this.active = 2\n            console.log(\"为待审核\")\n          }\n          //查询是否  为待批准\n          else if(this.rControl.fActStatus == 2){\n            this.active = 3\n            console.log(\"为待审核批准\")\n          }\n          //查询是否  为完成\n          else if(this.rControl.fActStatus == 3){\n            this.active = 4\n            console.log(\"为完成\")\n          }\n          //查询是否  为驳回\n          else if(this.emergencyPass.fActStatus == 5){\n            this.active = 0\n            console.log(\"为驳回\")\n          }\n          //查询是否  不同意删除\n          else if(this.emergencyPass.fActStatus == 6){\n            this.active = 5\n            console.log(\"不同意删除\")\n          }\n        }\n\n      },\n\n      getDitc() {\n        getDictByType().then(response => {\n          this.audit = response.data\n        })\n      },\n      Personnel() {\n        getUserList().then(response => {\n          this.userList = response.data\n        })\n      },\n      openStartWorkFlow() {\n        if (this.rControl.fDispatchName == null || this.rControl.fDispatchName == '') {\n          this.$message.error(\"请填写计划名称\")\n          return false\n        } else if (this.rControl.fDispatchType == null || this.rControl.fDispatchType == '') {\n          this.$message.error(\"请填写计划类型\")\n          return false\n        } else if (this.rControl.fBudget == null || this.rControl.fBudget == '') {\n          this.$message.error(\"请填写预算\")\n          return false\n        } else if (this.rControl.fDispatchContent == null || this.rControl.fDispatchContent == '') {\n          this.$message.error(\"请填写计划概述\")\n          return false\n        } else if (this.rControl.fEditPersion == null || this.rControl.fEditPersion == '') {\n          this.$message.error(\"请填写编制人\")\n          return false\n        } else if (this.rControl.fEditTime == null || this.rControl.fEditTime == '') {\n          this.$message.error(\"请填写编制时间\")\n          return false\n        } else {\n          this.rControl.fActStatus = 1\n          this.rControl.fActPersion = this.radio\n          addControl(this.rControl).then(response => {\n            if (response.code == 200) {\n              this.msgSuccess(\"提交成功\");\n              this.init()\n              this.nextVisible = false;\n              this.getLatelyControl();\n            }\n\n          });\n        }\n      },\n\n      uploadedSuccess(response, file, fileList) {\n        this.rControl.fDispatchId = response.data.fId;\n        this.getFile();\n      },\n      handleRemove(file, fileList) {\n        this.GLOBAL.commonFun(this.rControl.fDispatchId);\n        this.rControl.fDispatchId = '';\n      },\n      handlePreview(file) {\n\t\t  // window.location.href = this.fileList[0].url;\r\n\t\t  window.open(this.fileList[0].url);\n\t  },\n      handleExceed(files, fileList) {\n        this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);\n      },\n      beforeRemove(file, fileList) {\n        return this.$confirm(`确定移除 ${file.name}？`);\n      },\n\n      submitForm() {\n        this.openStartWorkFlow()\n      },\n      /** 新增按钮操作 */\n      handleAdd() {\n        //将状态 设为 暂存\n        this.rControl.fActStatus = 0\n        // 提交表单  暂存\n        addControl(this.rControl).then(response => {\n          this.msgSuccess(\"暂存成功\");\n          this.getLatelyControl();\n        });\n      },\n      rControlInNull() {\n        this.rControl = {};\n        this.fileList = [];\n      },\n      getLatelyControl() {\n        this.rControlInNull()\n      },\n    }\n  };\n</script>\n<style lang=\"scss\">\n  .color409 {\n    color: #409eff;\n    cursor: pointer;\n  }\n</style>\n"]}]}